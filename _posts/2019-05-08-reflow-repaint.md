---
layout: post
title:  "回流和重绘"
date:   2019-05-08 11:51:54
categories: HTML CSS
tags: 回流 重绘
author: LpZ
---

回流和重绘，影响页面性能。本文将从浏览器的渲染过程开始详细讲解回流和重绘。(ps: 内容为学习摘录笔记)

## 浏览器的渲染过程
（渲染过程来自MDN）

![浏览器渲染过程](/image/浏览器渲染过程.png)

由上图，可以看到，浏览器渲染过程如下：
1. 解析HTML,生成DOM树，解析CSS,生成CSSOM树
2. 将DOM和CSSDOM树结合，生成render树
3. Layout/Reflow(回流)：根据生成的render树，进行回流，得到节点的几何信息（位置、大小等）
4. Raiting/Repaint(重绘)：根据渲染树以及回流得到的几何信息，得到节点的绝对像素
5. Display：将像素发给GPU，展示在页面上

下面通过图详细展示渲染过程的具体内容

### 生成渲染树

![渲染树](/image/浏览器渲染过程DOM.png)

为了构建渲染树，浏览器主要完成了以下工作：
1. 从DOM树的根节点开始遍历每个可见节点。
2. 对每个可见的节点，找到CSSOM树中对应的规则，并应用整合。
3. 根据每个可见节点以及其对应样式，组合生成渲染树

注意：第一点说到的可见节点，说明渲染树只包含可见节点。
那么不可见节点有哪些呢？不可见的节点包括：
- 一些通过CSS进行隐藏的节点。比如display: none(利用visibility和opacity隐藏的节点，还是会显示在渲染树上)
- 一些不会渲染输出的节点。比如script、meta、link等

## 什么是回流
